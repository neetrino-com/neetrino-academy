# План улучшения системы заданий v2.0

## Текущее состояние (v1.0.36)
- ✅ Все страницы работают
- ✅ Course Builder работает
- ✅ Система заданий работает (привязана к модулям)
- ✅ Группы работают
- ✅ Все API работают

## Цель
Переделать систему так, чтобы **ВСЕ элементы контента** (задания, тесты, чеклисты, лекции) были привязаны к **урокам**, а не к модулям.

## Поэтапный план изменений

### Этап 1: Подготовка (5 минут)
1. Создать резервную копию текущего состояния
2. Протестировать все основные функции
3. Зафиксировать рабочее состояние

### Этап 2: Изменение схемы базы данных (10 минут)
1. Обновить `prisma/schema.prisma`:
   - Убрать `moduleId` из `Assignment`
   - Добавить `lessonId` (обязательное поле)
   - Добавить `createdBy` в `Quiz`
   - Создать новые модели: `GroupQuiz`, `GroupChecklist`, `GroupLecture`
   - Добавить новые enum: `AssignmentType`, `AssignmentStatus`

2. Создать миграцию с обработкой существующих данных

### Этап 3: Обновление API (15 минут)
1. Исправить API курсов (`/api/admin/courses/[id]/route.ts`)
2. Исправить API уроков (`/api/lessons/[id]/route.ts`)
3. Обновить API заданий для работы с уроками
4. Создать новые API для групповых элементов

### Этап 4: Обновление UI (10 минут)
1. Исправить Course Builder для создания заданий в уроках
2. Обновить компоненты отображения заданий
3. Исправить ссылки и навигацию

### Этап 5: Тестирование (10 минут)
1. Протестировать создание курса с заданиями
2. Протестировать отображение заданий в уроках
3. Протестировать работу групп с заданиями

## Принципы изменений
- **Поэтапность**: Каждый этап должен быть протестирован
- **Безопасность**: Всегда есть возможность откатиться
- **Совместимость**: Старые данные должны работать
- **Простота**: Минимальные изменения для достижения цели

## Риски и их минимизация
- **Риск**: Поломка существующей функциональности
- **Минимизация**: Поэтапные изменения с тестированием

- **Риск**: Потеря данных
- **Минимизация**: Миграция с обработкой существующих данных

- **Риск**: Сложность отката
- **Минимизация**: Создание тегов после каждого этапа

## Ожидаемый результат
- Все задания привязаны к урокам
- Course Builder работает корректно
- Группы могут работать с заданиями из уроков
- Все страницы функционируют
- Система готова к дальнейшему развитию
